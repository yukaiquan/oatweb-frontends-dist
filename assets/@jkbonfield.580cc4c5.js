import{b as u}from"./buffer.66f81d03.js";import{b as Ye}from"./bzip2.7acc0326.js";import{L as Je}from"./@gmod.89422c98.js";var F=class{constructor(e,r=0,a=0){a!=0?(this.buf=u.Buffer.allocUnsafe(a),this.length=a):(this.buf=e,this.length=e.length),this.pos=r}EOF(){return this.pos>=this.length}ReadData(e){var r=this.buf.slice(this.pos,this.pos+e);return this.pos+=e,r}ReadByte(){const e=this.buf[this.pos];return this.pos++,e}ReadChar(){const e=this.buf[this.pos];return this.pos++,String.fromCharCode(e)}ReadUint16(){var e=this.ReadByte();return e|=this.ReadByte()<<8,e}ReadUint32(){const e=this.buf.readInt32LE(this.pos);return this.pos+=4,e}ReadString(){var e="";do{var r=this.buf[this.pos++];r&&(e+=String.fromCharCode(r))}while(r);return e}ReadUint7(){var e=0;do{var r=this.ReadByte();e=e<<7|r&127}while(r&128);return e}ReadITF8(){var e=this.buf[this.pos];return this.pos++,e>=240?(e=(e&15)<<28,e+=(this.buf[this.pos+0]<<20)+(this.buf[this.pos+1]<<12)+(this.buf[this.pos+2]<<4)+(this.buf[this.pos+3]>>4),this.pos+=4):e>=224?(e=(e&15)<<24,e+=(this.buf[this.pos+0]<<16)+(this.buf[this.pos+1]<<8)+(this.buf[this.pos+2]<<0),this.pos+=3):e>=192?(e=(e&31)<<16,e+=(this.buf[this.pos+0]<<8)+(this.buf[this.pos+1]<<0),this.pos+=2):e>=128&&(e=(e&63)<<8,e+=this.buf[this.pos],this.pos++),e}WriteByte(e){this.buf[this.pos++]=e}WriteChar(e){this.buf[this.pos++]=e.charCodeAt(0)}WriteString(e){for(var r=0;r<e.length;r++)this.buf[this.pos++]=e.charCodeAt(r);this.buf[this.pos++]=0}WriteData(e,r){for(var a=0;a<r;a++)this.buf[this.pos++]=e[a]}WriteStream(e){this.WriteData(e.buf,e.pos)}WriteUint16(e){this.WriteByte(e&255),this.WriteByte(e>>8&255)}WriteUint32(e){this.buf.writeInt32LE(e,this.pos),this.pos+=4}WriteUint7(e){var r=0,a=e;do r+=7,a>>=7;while(a>0);do r-=7,this.WriteByte((e>>r&127)+((r>0)<<7));while(r>0)}WriteITF8(e){e<0&&(e=(1<<32)+e),e<=127?this.buf[this.pos++]=e:e<=16383?(this.buf[this.pos++]=128|Math.floor(e/256),this.buf[this.pos++]=e&255):e<131071?(this.buf[this.pos++]=192|Math.floor(e/65536),this.buf[this.pos++]=Math.floor(e/256)&255,this.buf[this.pos++]=e&255):e<268435455?(this.buf[this.pos++]=224|Math.floor(e/16777216),this.buf[this.pos++]=Math.floor(e/65536)&255,this.buf[this.pos++]=Math.floor(e/256)&255,this.buf[this.pos++]=e&255):(this.buf[this.pos++]=240|Math.floor(e/268435456),this.buf[this.pos++]=Math.floor(e/1048576)&255,this.buf[this.pos++]=Math.floor(e/4096)&255,this.buf[this.pos++]=Math.floor(e/4)&255,this.buf[this.pos++]=e&15)}WriteByteNeg(e){this.buf[--this.pos]=e}};const S=F;function J(t){return t&4095}function Qe(t,e){for(var r=0;e>=t[r+1];)r++;return r}function pe(t){for(var e=new Array(4096),r=0,a=0;a<4096;a++){for(;a>=t[r+1];)r++;e[a]=r}return e}function Q(t,e,r){return r*(t>>12)+(t&4095)-e}function N(t,e){for(;e<1<<23;)e=(e<<8)+t.ReadByte();return e}function Me(){return 1<<23}function Ue(t,e){e.WriteByteNeg(t>>24&255),e.WriteByteNeg(t>>16&255),e.WriteByteNeg(t>>8&255),e.WriteByteNeg(t>>0&255)}function Ne(t,e,r,a){for(var n=(8388608>>a<<8)*r;t>=n;)e.WriteByteNeg(t&255),t>>=8;return t}function H(t,e,r,a,n){return t=Ne(t,e,a,n),t=(Math.floor(t/a)<<n)+t%a+r,t}function je(t){var e=new S(t),r=e.ReadByte();e.ReadUint32();var a=e.ReadUint32();return r==0?rr(e,a):fr(e,a)}function er(t,e){return e==0?tr(t):lr(t)}function qe(t,e,r){for(var a=0;a<256;a++)e[a]=0;var n=t.ReadByte(),f=n,o=0;do{var i=t.ReadITF8();e[n]=i,o>0?(o--,n++):(n=t.ReadByte(),n==f+1&&(o=t.ReadByte())),f=n}while(n!=0);r[0]=0;for(var a=0;a<=255;a++)r[a+1]=r[a]+e[a]}function rr(t,e){var r=new Array(256),a=new Array(256);qe(t,r,a);for(var n=pe(a),f=new Array(4),o=0;o<4;o++)f[o]=t.ReadUint32();for(var i=new u.Buffer.allocUnsafe(e),o=0;o<e;o++){var v=o%4,h=J(f[v]),l=n[h];i[o]=l,f[v]=Q(f[v],a[l],r[l]),f[v]=N(t,f[v])}return i}function ar(t,e){for(var r=0;r<256;r++)e[r]=0;for(var r=0;r<t.length;r++)e[t[r]]++}function Ee(t){for(var e=0,r=0;r<256;r++)e+=t[r];const a=1<<12;var n=a/e;do{var f=0,o=0,i=0;e=0;for(var r=0;r<256;r++)t[r]!=0&&(f<t[r]&&(f=t[r],o=r),t[r]=Math.floor(t[r]*n),t[r]==0&&(t[r]=1),e+=t[r]);e<a?t[o]+=a-e:e-a<t[o]/2&&t[o]>2?t[o]-=e-a:e!=a&&(n=n*.99,i=1)}while(i)}function xe(t,e){for(var r=0,a=0;a<256;a++)if(!!e[a]){if(r>0)r--;else if(t.WriteByte(a),a>0&&e[a-1]>0){for(r=a+1;r<256&&e[r];r++);r-=a+1,t.WriteByte(r)}t.WriteITF8(e[a])}t.WriteByte(0)}function tr(t){const e=t.length;var r=new S("",0,257*3+9);r.WriteByte(0),r.WriteUint32(0),r.WriteUint32(0);var a=new Array(256);ar(t,a),Ee(a),xe(r,a);var n=new Array(256);n[0]=0;for(var f=1;f<256;f++)n[f]=n[f-1]+a[f-1];for(var o=new Array(4),f=0;f<4;f++)o[f]=Me();for(var i=Math.floor(e*1.05+100),v=new S("",i,i),f=e-1;f>=0;f--)o[f%4]=H(o[f%4],v,n[t[f]],a[t[f]],12);for(var f=3;f>=0;f--)Ue(o[f],v);var h=r.pos;return r.buf.writeInt32LE(h-9+(v.length-v.pos),1),r.buf.writeInt32LE(e,5),u.Buffer.concat([r.buf.slice(0,r.pos),v.buf.slice(v.pos,v.length)],r.pos+v.length-v.pos)}function nr(t,e,r){for(var a=0;a<256;a++){e[a]=new Array(256),r[a]=new Array(256);for(var n=0;n<256;n++)e[a][n]=0}var f=t.ReadByte(),o=f,i=0;do qe(t,e[f],r[f]),i>0?(i--,f++):(f=t.ReadByte(),f==o+1&&(i=t.ReadByte())),o=f;while(f!=0)}function fr(t,e){var r=new Array(256),a=new Array(256);nr(t,r,a);for(var n=new Array(256),f=0;f<256;f++)n[f]=pe(a[f]);for(var o=new Array(4),i=new Array(4),v=0;v<4;v++)o[v]=t.ReadUint32(),i[v]=0;for(var h=new u.Buffer.allocUnsafe(e),l=Math.floor(e/4),f=0;f<l;f++)for(var v=0;v<4;v++){var s=J(o[v]),d=n[i[v]][s];h[f+v*l]=d,o[v]=Q(o[v],a[i[v]][d],r[i[v]][d]),o[v]=N(t,o[v]),i[v]=d}for(f=4*f;f<e;){var s=J(o[3]),d=Qe(a[i[3]],s);h[f++]=d,o[3]=Q(o[3],a[i[3]][d],r[i[3]][d]),o[3]=N(t,o[3]),i[3]=d}return h}function or(t,e,r){for(var a=0;a<256;a++){r[a]=0;for(var n=0;n<256;n++)e[a][n]=0}for(var f=0,a=0;a<t.length;a++)r[t[a]]++,e[f][t[a]]++,f=t[a];e[0][t[1*(t.length>>2)]]++,e[0][t[2*(t.length>>2)]]++,e[0][t[3*(t.length>>2)]]++,r[0]+=3}function ir(t,e){for(var r=0;r<256;r++)e[r]&&Ee(t[r])}function vr(t,e,r){for(var a=0,n=0;n<256;n++)if(!!r[n]){if(a>0)a--;else if(t.WriteByte(n),n>0&&r[n-1]>0){for(a=n+1;a<256&&r[a];a++);a-=n+1,t.WriteByte(a)}xe(t,e[n])}t.WriteByte(0)}function lr(t){const e=t.length;var r=new S("",0,257*257*3+9);r.WriteByte(1),r.WriteUint32(0),r.WriteUint32(0);for(var a=new Array(256),n=new Array(256),f=new Array(256),o=0;o<256;o++)n[o]=new Array(256),f[o]=new Array(256);or(t,n,a),ir(n,a),vr(r,n,a);for(var o=0;o<256;o++)if(!!a[o]){f[o][0]=0;for(var i=1;i<256;i++)f[o][i]=f[o][i-1]+n[o][i-1]}for(var v=new Array(4),h=new Array(4),i=0;i<4;i++)v[i]=Me(),h[i]=0;for(var l=new S("",e,e),s=Math.floor(e/4),d=new Array(4),c=new Array(4),i=0;i<4;i++)d[i]=(i+1)*s-2,c[i]=t[d[i]+1];c[3]=t[e-1];for(var o=e-2;o>4*s-2;o--)v[3]=H(v[3],l,f[t[o]][c[3]],n[t[o]][c[3]],12),c[3]=t[o];for(;d[0]>=0;)for(var i=3;i>=0;i--){var y=t[d[i]];v[i]=H(v[i],l,f[y][c[i]],n[y][c[i]],12),c[i]=y,d[i]--}for(var i=3;i>=0;i--)v[i]=H(v[i],l,f[0][c[i]],n[0][c[i]],12);for(var o=3;o>=0;o--)Ue(v[o],l);var g=r.pos;return r.buf.writeInt32LE(g-9+(l.length-l.pos),1),r.buf.writeInt32LE(e,5),u.Buffer.concat([r.buf.slice(0,r.pos),l.buf.slice(l.pos,l.length)],r.pos+l.length-l.pos)}var hr={decode:je,encode:er};const A=F;function j(t,e){return t&(1<<e)-1}function sr(t,e){for(var r=0;e>=t[r+1];)r++;return r}function Se(t,e){for(var r=1<<e,a=new Array(r),n=0,f=0;f<r;f++){for(;f>=t[n+1];)n++;a[f]=n}return a}function ee(t,e,r,a){return r*(t>>a)+(t&(1<<a)-1)-e}function re(t,e){return e<1<<15&&(e=(e<<16)+t.ReadUint16()),e}function De(){return 1<<15}function Le(t,e){e.WriteByteNeg(t>>24&255),e.WriteByteNeg(t>>16&255),e.WriteByteNeg(t>>8&255),e.WriteByteNeg(t>>0&255)}function dr(t,e,r,a){for(var n=(1<<31-a)*r;t>=n;)e.WriteByteNeg(t>>8&255),e.WriteByteNeg(t&255),t>>=16;return t}function Z(t,e,r,a,n){return t=dr(t,e,a,n),t=(Math.floor(t/a)<<n)+t%a+r,t}function cr(t){for(var e=new Array(256),r=0;r<256;r++)e[r]=0;for(var a=-1,r=0;r<t.length;r++)e[t[r]]+=t[r]==a?1:-1,a=t[r];for(var n=0,r=0;r<256;r++)e[r]>0&&n++;n||(n=1,e[0]=1);var l=new A("",0,n+1+t.length);l.WriteByte(n);for(var r=0;r<256;r++)e[r]>0&&l.WriteByte(r);for(var f=new u.Buffer.allocUnsafe(t.length),o=0,r=0;r<t.length;r++)if(f[o++]=t[r],e[t[r]]>0){a=t[r];for(var i=0;r+i+1<t.length&&t[r+i+1]==a;)i++;l.WriteUint7(i),r+=i}var v=ce(l.buf.slice(0,l.pos)),h=new A("",0,16);h.WriteUint7(l.pos*2),h.WriteUint7(o),h.WriteUint7(v.length);var l=u.Buffer.concat([h.buf.slice(0,h.pos),v]);return[l,f.slice(0,o)]}function ur(t){var e=t.ReadUint7(),r=t.ReadUint7();if(e&1)var n=t.ReadData((e-1)/2);else{var a=t.ReadUint7(),n=t.ReadData(a);n=se(new A(n),e/2)}var n=new A(n),f=new Array(256),o=n.ReadByte();o==0&&(o=256);for(var i=0;i<o;i++)f[n.ReadByte()]=1;return[f,n,r]}function yr(t,e,r,a){new A(t);for(var n=new u.Buffer.allocUnsafe(a),f=0,o=0;f<a;o++){var i=t[o];if(e[i])for(var v=r.ReadUint7(),h=0;h<=v;h++)n[f++]=i;else n[f++]=i}return n}function wr(t){for(var e=new Array(256),r=0;r<256;r++)e[r]=0;for(var r=0;r<t.length;r++)e[t[r]]++;for(var a=new Array(256),n=0,r=0;r<256;r++)e[r]>0&&(a[r]=n++);if(!(n>16)){if(n<=1)var f=new u.Buffer.allocUnsafe(0);else if(n<=2){var f=new u.Buffer.allocUnsafe(Math.ceil(t.length/8)),i=-1;for(r=0;r<t.length;r++)r%8==0&&(f[++i]=0),f[i]+=a[t[r]]<<r%8}else if(n<=4){var f=new u.Buffer.allocUnsafe(Math.ceil(t.length/4)),i=-1;for(r=0;r<t.length;r++)r%4==0&&(f[++i]=0),f[i]+=a[t[r]]<<r%4*2}else{var f=new u.Buffer.allocUnsafe(Math.ceil(t.length/2)),i=-1;for(r=0;r<t.length;r++)r%2==0&&(f[++i]=0),f[i]+=a[t[r]]<<r%2*4}var o=new A("",0,n+5);o.WriteByte(n);for(var i=0,r=0;r<256;r++)e[r]>0&&(e[r]=i++,o.WriteByte(r));return o.WriteUint7(f.length),[o.buf.slice(0,o.pos),f]}}function gr(t){for(var e=t.ReadByte(),r=new Array(e),a=0;a<e;a++)r[a]=t.ReadByte();var n=t.ReadUint7();return[r,e,n]}function Rr(t,e,r,a){var n=new u.Buffer.allocUnsafe(a),f=0;if(r<=1)for(var o=0;o<a;o++)n[o]=e[0];else if(r<=2)for(o=0;o<a;o++){if(o%8==0)var i=t[f++];n[o]=e[i&1],i>>=1}else if(r<=4)for(o=0;o<a;o++){if(o%4==0)var i=t[f++];n[o]=e[i&3],i>>=2}else if(r<=16)for(o=0;o<a;o++){if(o%2==0)var i=t[f++];n[o]=e[i&15],i>>=4}return n}function _r(t,e,r){r==0&&(r=4);for(var a=new Array(r),n=new Array(r),f=0;f<r;f++)n[f]=Math.floor(e.length/r)+(e.length%r>f),a[f]=new Array(n[f]);for(var o=0,i=0;i<e.length;i+=r,o++)for(var v=0;v<r;v++)o<a[v].length&&(a[v][o]=e[i+v]);for(var h=new Array(r),l=0,f=0;f<r;f++){var s=ae(a[f],0),d=ae(a[f],1);h[f]=d.length<s.length?d:s,l+=h[f].length}var c=new A("",0,l+5*r+1);c.WriteByte(r);for(var f=0;f<r;f++)c.WriteUint7(h[f].length);for(var f=0;f<r;f++)c.WriteData(h[f],h[f].length);return c.buf.slice(0,c.buf.pos)}function Ar(t,e){for(var r=t.ReadByte(),a=new Array(r),n=new Array(r),f=0;f<r;f++)a[f]=t.ReadUint7();for(var o=new Array(r),f=0;f<r;f++)n[f]=Math.floor(e/r)+(e%r>f),o[f]=$e(t,n[f]);for(var i=new u.Buffer.allocUnsafe(e),f=0;f<r;f++)for(var v=0;v<n[f];v++)i[v*r+f]=o[f][v];return i}function br(t){var e=new A(t);return $e(e,0)}function $e(t,e){var r=t.ReadByte(),a=r&1,n=r&8,f=r&16,o=r&32,i=r&64,v=r&128;if(f||(e=t.ReadUint7()),n)return Ar(t,e);if(v)var h=e,[l,s,e]=gr(t);if(i)var d=e,[c,y,e]=ur(t);if(o)var g=t.ReadData(e);else if(a==0)var g=se(t,e);else var g=Mr(t,e);return i&&(g=yr(g,c,y,d)),v&&(g=Rr(g,l,s,h)),g}function ae(t,e){var r=new A("",0,10);r.WriteByte(e);var a=e&1,n=e&8,f=e&16,o=e&32,i=e&64,v=e&128,h=e>>8;if(f||r.WriteUint7(t.length),n)return u.Buffer.concat([r.buf.slice(0,r.pos),_r(r,t,h)]);var l=new u.Buffer.alloc(0);v&&([l,t]=wr(t));var s=new u.Buffer.alloc(0);if(i&&([s,t]=cr(t)),t.length<4&&a==1&&(a=0,r.buf[0]&=-2),o)var d=t;else if(a==0)var d=ce(t);else var d=Sr(t);return u.Buffer.concat([r.buf.slice(0,r.pos),l,s,d])}function Ie(t){for(var e=new Array(256),r=0;r<256;r++)e[r]=0;var a=0,n=t.ReadByte(),f=n;do e[n]=1,a>0?(a--,n++):(n=t.ReadByte(),n==f+1&&(a=t.ReadByte())),f=n;while(n!=0);return e}function Br(t,e,r){for(var a=0;a<256;a++)e[a]=0;for(var n=Ie(t),a=0;a<256;a++)n[a]>0&&(e[a]=t.ReadUint7());de(e,12),r[0]=0;for(var a=0;a<=255;a++)r[a+1]=r[a]+e[a]}function se(t,e){var r=new Array(256),a=new Array(256);Br(t,r,a);for(var n=Se(a,12),f=new Array(4),o=0;o<4;o++)f[o]=t.ReadUint32();for(var i=new u.Buffer.allocUnsafe(e),o=0;o<e;o++){var v=o%4,h=j(f[v],12),l=n[h];i[o]=l,f[v]=ee(f[v],a[l],r[l],12),f[v]=re(t,f[v])}return i}function Wr(t,e){for(var r=0;r<256;r++)e[r]=0;for(var r=0;r<t.length;r++)e[t[r]]++}function te(t,e){for(var r=0,a=0;a<256;a++)r+=t[a];const n=1<<e;var f=n/r;do{var o=0,i=0,v=0;r=0;for(var a=0;a<256;a++)t[a]!=0&&(o<t[a]&&(o=t[a],i=a),t[a]=Math.floor(t[a]*f),t[a]==0&&(t[a]=1),r+=t[a]);r<n?t[i]+=n-r:r-n<t[i]/2&&t[i]>2?t[i]-=r-n:r!=n&&(f=n/r,v=1)}while(v)}function de(t,e){for(var r=0,a=0;a<256;a++)r+=t[a];if(!(r==0||r==1<<e)){for(var n=0;r<1<<e;)r*=2,n++;for(var a=0;a<256;a++)t[a]<<=n}}function ke(t,e){for(var r=0,a=0;a<256;a++)if(!!e[a]){if(r>0)r--;else if(t.WriteByte(a),a>0&&e[a-1]>0){for(r=a+1;r<256&&e[r];r++);r-=a+1,t.WriteByte(r)}}t.WriteByte(0)}function mr(t,e){ke(t,e);for(var r=0;r<256;r++)e[r]&&t.WriteUint7(e[r])}function ce(t){const e=t.length;var r=new A("",0,257*3+9),a=new Array(256);Wr(t,a);var n=Math.ceil(Math.log2(e));n>12&&(n=12),te(a,n),mr(r,a),te(a,12);var f=new Array(256);f[0]=0;for(var o=1;o<256;o++)f[o]=f[o-1]+a[o-1];for(var i=new Array(4),o=0;o<4;o++)i[o]=De();for(var v=new A("",e*1.05+100>>0,e*1.05+100>>0),o=e-1;o>=0;o--)i[o%4]=Z(i[o%4],v,f[t[o]],a[t[o]],12);for(var o=3;o>=0;o--)Le(i[o],v);return u.Buffer.concat([r.buf.slice(0,r.pos),v.buf.slice(v.pos,v.length)],r.pos+v.length-v.pos)}function pr(t,e,r,a){for(var n=0;n<256;n++){e[n]=new Array(256),r[n]=new Array(256);for(var f=0;f<256;f++)e[n][f]=0}for(var o=Ie(t),n=0;n<256;n++)if(!!o[n]){for(var i=0,f=0;f<256;f++)!o[f]||(i>0?i--:(e[n][f]=t.ReadUint7(),e[n][f]==0&&(i=t.ReadByte())));de(e[n],a),r[n][0]=0;for(var f=0;f<256;f++)r[n][f+1]=r[n][f]+e[n][f]}}function Mr(t,e){var r=t.ReadByte(),a=r>>4,n=t;if(r&1)var f=t.ReadUint7(),o=t.ReadUint7(),r=new A(t.ReadData(o)),n=new A(se(r,f));var i=new Array(256),v=new Array(256);pr(n,i,v,a);for(var h=new Array(256),l=0;l<256;l++)h[l]=Se(v[l],a);for(var s=new Array(4),d=new Array(4),c=0;c<4;c++)s[c]=t.ReadUint32(),d[c]=0;for(var y=new u.Buffer.allocUnsafe(e),g=Math.floor(e/4),l=0;l<g;l++)for(var c=0;c<4;c++){var w=j(s[c],a),R=h[d[c]][w];y[l+c*g]=R,s[c]=ee(s[c],v[d[c]][R],i[d[c]][R],a),s[c]=re(t,s[c]),d[c]=R}for(l=4*l;l<e;){var w=j(s[3],a),R=sr(v[d[3]],w);y[l++]=R,s[3]=ee(s[3],v[d[3]][R],i[d[3]][R],a),s[3]=re(t,s[3]),d[3]=R}return y}function Ur(t,e,r){for(var a=0;a<256;a++){r[a]=0;for(var n=0;n<256;n++)e[a][n]=0}for(var f=0,a=0;a<t.length;a++)r[f]++,e[f][t[a]]++,f=t[a];r[f]++,e[0][t[1*(t.length>>2)]]++,e[0][t[2*(t.length>>2)]]++,e[0][t[3*(t.length>>2)]]++,r[0]+=3}function qr(t,e,r){for(var a=0;a<256;a++)if(!!e[a]){var n=Math.ceil(Math.log2(e[a]));n>r&&(n=r),te(t[a],n)}}function Er(t,e,r){for(var a=0;a<256;a++)e[a]&&de(t[a],r)}function xr(t,e,r){ke(t,r);for(var a=0;a<256;a++)if(!!r[a]){for(var n=0,f=0;f<256;f++)if(!!r[f]){if(n)n--;else if(t.WriteUint7(e[a][f]),!e[a][f]){for(var o=f+1;o<256;o++)if(!!r[o])if(e[a][o]==0)n++;else break;t.WriteByte(n)}}}}function Sr(t){const e=t.length;for(var r=new A("",0,257*257*3+9),a=new Array(256),n=new Array(256),f=new Array(256),o=0;o<256;o++)n[o]=new Array(256),f[o]=new Array(256);var i=12;Ur(t,n,a),qr(n,a,i);var v=new A("",0,257*257*3+9);xr(v,n,a);var h=ce(v.buf.slice(0,v.pos));h.length<v.pos?(r.WriteByte(1|i<<4),r.WriteUint7(v.pos),r.WriteUint7(h.length),r.WriteData(h,h.length)):(r.WriteByte(0|i<<4),r.WriteData(v.buf,v.pos)),Er(n,a,i);for(var o=0;o<256;o++)if(!!a[o]){f[o][0]=0;for(var l=1;l<256;l++)f[o][l]=f[o][l-1]+n[o][l-1]}for(var s=new Array(4),d=new Array(4),l=0;l<4;l++)s[l]=De(),d[l]=0;for(var c=new A("",e*1.05+100>>0,e*1.05+100>>0),y=Math.floor(e/4),g=new Array(4),w=new Array(4),l=0;l<4;l++)g[l]=(l+1)*y-2,w[l]=t[g[l]+1];w[3]=t[e-1];for(var o=e-2;o>4*y-2;o--)s[3]=Z(s[3],c,f[t[o]][w[3]],n[t[o]][w[3]],i),w[3]=t[o];for(;g[0]>=0;)for(var l=3;l>=0;l--){var R=t[g[l]];s[l]=Z(s[l],c,f[R][w[l]],n[R][w[l]],i),w[l]=R,g[l]--}for(var l=3;l>=0;l--)s[l]=Z(s[l],c,f[0][w[l]],n[0][w[l]],i);for(var o=3;o>=0;o--)Le(s[o],c);return u.Buffer.concat([r.buf.slice(0,r.pos),c.buf.slice(c.pos,c.length)],r.pos+c.length-c.pos)}var Ce={decode:br,encode:ae},Fe=class{constructor(e){this.low=0,this.range=4294967295,this.code=0,this.FFnum=0,this.carry=0,this.cache=0}RangeStartDecode(e){for(var r=0;r<5;r++)this.code=(this.code<<8)+e.ReadByte();this.code&=4294967295,this.code>>>=0}RangeGetFrequency(e){return this.range=Math.floor(this.range/e),Math.floor(this.code/this.range)}RangeDecode(e,r,a,n){for(this.code-=r*this.range,this.range*=a;this.range<1<<24;)this.range*=256,this.code=this.code*256+e.ReadByte()}RangeShiftLow(e){if(this.low<4278190080|this.carry){for(e.WriteByte(this.cache+this.carry);this.FFnum;)e.WriteByte(this.carry-1),this.FFnum--;this.cache=this.low>>>24,this.carry=0}else this.FFnum++;this.low<<=8,this.low>>>=0}RangeEncode(e,r,a,n){var f=this.low;for(this.range=Math.floor(this.range/n),this.low+=r*this.range,this.low>>>=0,this.range*=a,this.low<f&&(this.carry!=0&&console.log("ERROR: Multiple carry"),this.carry=1);this.range<1<<24;)this.range*=256,this.RangeShiftLow(e)}RangeFinishEncode(e){for(var r=0;r<5;r++)this.RangeShiftLow(e)}};const _e=(1<<16)-17,G=16;var Oe=class{constructor(e=256){this.total_freq=e,this.max_sym=e-1,this.S=new Array,this.F=new Array;for(var r=0;r<=this.max_sym;r++)this.S[r]=r,this.F[r]=1}ModelDecode(e,r){for(var a=r.RangeGetFrequency(this.total_freq),n=0,f=0;n+this.F[f]<=a;)n+=this.F[f++];r.RangeDecode(e,n,this.F[f],this.total_freq),this.F[f]+=G,this.total_freq+=G,this.total_freq>_e&&this.ModelRenormalise();var o=this.S[f];if(f>0&&this.F[f]>this.F[f-1]){var i=this.F[f];this.F[f]=this.F[f-1],this.F[f-1]=i,i=this.S[f],this.S[f]=this.S[f-1],this.S[f-1]=i}return o}ModelRenormalise(){this.total_freq=0;for(var e=0;e<=this.max_sym;e++)this.F[e]-=Math.floor(this.F[e]/2),this.total_freq+=this.F[e]}ModelEncode(e,r,o){for(var n=0,f=0;this.S[f]!=o;f++)n+=this.F[f];r.RangeEncode(e,n,this.F[f],this.total_freq),this.F[f]+=G,this.total_freq+=G,this.total_freq>_e&&this.ModelRenormalise();var o=this.S[f];if(f>0&&this.F[f]>this.F[f-1]){var i=this.F[f];this.F[f]=this.F[f-1],this.F[f-1]=i,i=this.S[f],this.S[f]=this.S[f-1],this.S[f-1]=i}}};const M=Fe,P=F,b=Oe,Y=Ye,Ae=1,Dr=4,be=8,Be=16,Lr=32,We=64,z=128;var Ge=class{decode(e){return this.stream=new P(e),this.decodeStream(this.stream)}decodeStream(e,r=0){var a=this.stream.ReadByte();a&Be||(r=this.stream.ReadUint7());var n=r,f=a&Ae;if(a&be)return this.decodeStripe(this.stream,r);if(a&z){var o;[o,n]=this.decodePackMeta(this.stream)}if(a&Lr)var i=this.decodeCat(this.stream,n);else if(a&Dr)var i=this.decodeExt(this.stream,n);else if(a&We)var i=f?this.decodeRLE1(this.stream,n):this.decodeRLE0(this.stream,n);else var i=f?this.decode1(this.stream,n):this.decode0(this.stream,n);return a&z&&(i=this.decodePack(i,o,r)),i}encode(e,r){if(this.stream=new P("",0,e.length*1.1+100),this.stream.WriteByte(r),r&Be||this.stream.WriteUint7(e.length),r&be)return u.Buffer.concat([this.stream.buf.slice(0,this.stream.pos),this.encodeStripe(this.stream,e,r>>8)]);var a=r&Ae,n=e.length,f;return r&z&&([f,e,n]=this.encodePack(e)),r&z&&this.stream.WriteStream(f),r&We?a?this.encodeRLE1(e,n,this.stream):this.encodeRLE0(e,n,this.stream):a?this.encode1(e,n,this.stream):this.encode0(e,n,this.stream)}decode0(e,r){var a=new u.Buffer.allocUnsafe(r),n=e.ReadByte();n==0&&(n=256);var f=new b(n),o=new M(e);o.RangeStartDecode(e);for(var i=0;i<r;i++)a[i]=f.ModelDecode(e,o);return a}encode0(e,r,a){for(var n=0,f=0;f<r;f++)n<e[f]&&(n=e[f]);n++;var o=new b(n);a.WriteByte(n);for(var i=new M(a),f=0;f<r;f++)o.ModelEncode(a,i,e[f]);return i.RangeFinishEncode(a),a.buf.slice(0,a.pos)}decode1(e,r){var a=new u.Buffer.allocUnsafe(r),n=e.ReadByte();n==0&&(n=256);for(var f=new Array(n),o=0;o<n;o++)f[o]=new b(n);var i=new M(e);i.RangeStartDecode(e);for(var v=0,o=0;o<r;o++)a[o]=f[v].ModelDecode(e,i),v=a[o];return a}encode1(e,r,a){for(var n=0,f=0;f<r;f++)n<e[f]&&(n=e[f]);n++;for(var o=new Array(n),f=0;f<n;f++)o[f]=new b(n);a.WriteByte(n);for(var i=new M(a),v=0,f=0;f<r;f++)o[v].ModelEncode(a,i,e[f]),v=e[f];return i.RangeFinishEncode(a),a.buf.slice(0,a.pos)}decodeExt(e,r){var a=new u.Buffer.allocUnsafe(r),n=Y.array(e.buf.slice(e.pos)),f=Y.header(n),o=0;do{var i=Y.decompress(n,f);i!=-1&&(u.Buffer.from(i).copy(a,o),o+=i.length,f-=i.length)}while(i!=-1);return a}encodeExt(e,r){}decodeRLE0(e,r){var a=new u.Buffer.allocUnsafe(r),n=e.ReadByte();n==0&&(n=256);for(var f=new b(n),o=new Array(258),v=0;v<=257;v++)o[v]=new b(4);var i=new M(e);i.RangeStartDecode(e);for(var v=0;v<r;){a[v]=f.ModelDecode(e,i);for(var h=o[a[v]].ModelDecode(e,i),l=h,s=256;h==3;)h=o[s].ModelDecode(e,i),s=257,l+=h;for(var d=1;d<=l;d++)a[v+d]=a[v];v+=l+1}return a}encodeRLE0(e,r,a){for(var n=0,v=0;v<r;v++)n<e[v]&&(n=e[v]);n++;for(var f=new b(n),o=new Array(258),v=0;v<=257;v++)o[v]=new b(4);a.WriteByte(n);for(var i=new M(a),v=0;v<r;){f.ModelEncode(a,i,e[v]);for(var h=1;v+h<r&&e[v+h]==e[v];)h++;h--;var l=e[v];e[v],v+=h+1;var s=h>=3?3:h;for(o[l].ModelEncode(a,i,s),h-=s,l=256;s==3;)s=h>=3?3:h,o[l].ModelEncode(a,i,s),l=257,h-=s}return i.RangeFinishEncode(a),a.buf.slice(0,a.pos)}decodeRLE1(e,r){var a=new u.Buffer.allocUnsafe(r),n=e.ReadByte();n==0&&(n=256);for(var f=new Array(n),h=0;h<n;h++)f[h]=new b(n);for(var o=new Array(258),h=0;h<=257;h++)o[h]=new b(4);var i=new M(e);i.RangeStartDecode(e);for(var v=0,h=0;h<r;){a[h]=f[v].ModelDecode(e,i),v=a[h];for(var l=o[a[h]].ModelDecode(e,i),s=l,d=256;l==3;)l=o[d].ModelDecode(e,i),d=257,s+=l;for(var c=1;c<=s;c++)a[h+c]=a[h];h+=s+1}return a}encodeRLE1(e,r,a){for(var n=0,v=0;v<r;v++)n<e[v]&&(n=e[v]);n++;for(var f=new Array(n),v=0;v<n;v++)f[v]=new b(n);for(var o=new Array(258),v=0;v<=257;v++)o[v]=new b(4);a.WriteByte(n);for(var i=new M(a),v=0,h=0;v<r;){f[h].ModelEncode(a,i,e[v]);for(var l=1;v+l<r&&e[v+l]==e[v];)l++;l--;var s=e[v];h=e[v],v+=l+1;var d=l>=3?3:l;for(o[s].ModelEncode(a,i,d),l-=d,s=256;d==3;)d=l>=3?3:l,o[s].ModelEncode(a,i,d),s=257,l-=d}return i.RangeFinishEncode(a),a.buf.slice(0,a.pos)}decodePackMeta(e){this.nsym=e.ReadByte();for(var r=new Array(this.nsym),a=0;a<this.nsym;a++)r[a]=e.ReadByte();var n=e.ReadUint7();return[r,n]}decodePack(e,r,a){var n=new u.Buffer.allocUnsafe(a);if(this.nsym<=1)for(var f=0;f<a;f++)n[f]=r[0];else if(this.nsym<=2)for(var f=0,o=0;f<a;f++){if(f%8==0)var i=e[o++];n[f]=r[i&1],i>>=1}else if(this.nsym<=4)for(var f=0,o=0;f<a;f++){if(f%4==0)var i=e[o++];n[f]=r[i&3],i>>=2}else if(this.nsym<=16)for(var f=0,o=0;f<a;f++){if(f%2==0)var i=e[o++];n[f]=r[i&15],i>>=4}else return e;return n}packMeta(e){for(var r=new P("",0,1024),a=new Array(256),n=0;n<e.length;n++)a[e[n]]=1;for(var f=0,n=0;n<256;n++)a[n]&&(a[n]=++f);r.WriteByte(f);for(var n=0;n<256;n++)a[n]&&(r.WriteByte(n),a[n]--);return[r,a,f]}encodePack(e){var r,a,n;[r,a,n]=this.packMeta(e);var f=e.length,o=0;if(n<=1)return r.WriteUint7(0),[r,new u.Buffer.allocUnsafe(0),0];if(n<=2){for(var i=new u.Buffer.allocUnsafe(Math.floor((f+7)/8)),o=0,v=0;o<(f&-8);o+=8,v++)i[v]=(a[e[o+0]]<<0)+(a[e[o+1]]<<1)+(a[e[o+2]]<<2)+(a[e[o+3]]<<3)+(a[e[o+4]]<<4)+(a[e[o+5]]<<5)+(a[e[o+6]]<<6)+(a[e[o+7]]<<7);if(o<f){i[v]=0;for(var h=0;o<f;)i[v]|=a[e[o++]]<<h,h++;v++}return r.WriteUint7(v),[r,i,i.length]}if(n<=4){for(var i=new u.Buffer.allocUnsafe(Math.floor((f+3)/4)),o=0,v=0;o<(f&-4);o+=4,v++)i[v]=(a[e[o+0]]<<0)+(a[e[o+1]]<<2)+(a[e[o+2]]<<4)+(a[e[o+3]]<<6);if(o<f){i[v]=0;for(var h=0;o<f;)i[v]|=a[e[o++]]<<h,h+=2;v++}return r.WriteUint7(v),[r,i,i.length]}if(n<=16){for(var i=new u.Buffer.allocUnsafe(Math.floor((f+1)/2)),o=0,v=0;o<(f&-2);o+=2,v++)i[v]=(a[e[o+0]]<<0)+(a[e[o+1]]<<4);return o<f&&(i[v++]=a[e[o++]]),r.WriteUint7(v),[r,i,i.length]}return r.WriteUint7(e.length),[r,e,e.length]}encodeStripe(e,r,a){a==0&&(a=4);for(var n=new Array(a),f=new Array(a),o=0;o<a;o++)f[o]=Math.floor(r.length/a)+(r.length%a>o),n[o]=new Array(f[o]);for(var i=0,v=0;v<r.length;v+=a,i++)for(var h=0;h<a;h++)i<n[h].length&&(n[h][i]=r[v+h]);for(var l=new Array(a),s=0,o=0;o<a;o++){var d=this.encode(n[o],0),c=this.encode(n[o],1);l[o]=c.length<d.length?c:d,s+=l[o].length}var y=new P("",0,s+5*a+1);y.WriteByte(a);for(var o=0;o<a;o++)y.WriteUint7(l[o].length);for(var o=0;o<a;o++)y.WriteData(l[o],l[o].length);return y.buf.slice(0,y.buf.pos)}decodeStripe(e,r){for(var a=e.ReadByte(),n=new Array(a),f=new Array(a),o=0;o<a;o++)n[o]=e.ReadUint7();for(var i=new Array(a),o=0;o<a;o++)f[o]=Math.floor(r/a)+(r%a>o),i[o]=this.decodeStream(e,f[o]);for(var v=new u.Buffer.allocUnsafe(r),o=0;o<a;o++)for(var h=0;h<f[o];h++)v[h*a+o]=i[o][h];return v}decodeCat(e,r){for(var a=new u.Buffer.allocUnsafe(r),n=0;n<r;n++)a[n]=e.ReadByte();return a}};const Pe=F,W=Oe,ze=Fe;function X(t,e,r){for(var a=0,n=0,f=-1,o=new Array(1024);n<r;){var i=t.ReadByte();if(o[a++]=i,n+=i,i==f){var v=t.ReadByte();for(n+=i*v;v--;)o[a++]=i}f=i}var h=0;for(a=0,n=0;n<r;){var l=0;do{var s=o[a++];l+=s}while(s==255);for(;l--;)e[n++]=h;h++}}const ue=2,Ke=4,He=8,ne=16,fe=32,oe=64,ie=128,ve=1,le=2,$r=4;function Ir(t,e,r){var a=t.context;return e.qctx=(e.qctx<<t.qshift)+t.qtab[r],a+=(e.qctx&(1<<t.qbits)-1)<<t.qloc,t.do_pos&&(a+=t.ptab[Math.min(e.p,1023)]<<t.ploc),t.do_delta&&(a+=t.dtab[Math.min(e.delta,255)]<<t.dloc,e.delta+=e.prevq!=r?1:0,e.prevq=r),t.do_sel&&(a+=e.s<<t.sloc),e.p--,a&65535}function kr(t){var e={};e.context=t.ReadUint16(),e.pflags=t.ReadByte(),e.do_dedup=e.pflags&ue,e.fixed_len=e.pflags&Ke,e.do_sel=e.pflags&He,e.do_qmap=e.pflags&ne,e.do_pos=e.pflags&fe,e.do_delta=e.pflags&oe,e.do_qtab=e.pflags&ie,e.max_sym=t.ReadByte();var r=t.ReadByte();if(e.qbits=r>>4,e.qshift=r&15,r=t.ReadByte(),e.qloc=r>>4,e.sloc=r&15,r=t.ReadByte(),e.ploc=r>>4,e.dloc=r&15,e.qmap=new Array(256),e.pflags&ne)for(var a=0;a<e.max_sym;a++)e.qmap[a]=t.ReadByte();else for(var a=0;a<256;a++)e.qmap[a]=a;if(e.qtab=new Array(1024),e.qbits>0&&e.pflags&ie)X(t,e.qtab,256);else for(var a=0;a<256;a++)e.qtab[a]=a;return e.ptab=new Array(1024),e.pflags&fe&&X(t,e.ptab,1024),e.dtab=new Array(256),e.pflags&oe&&X(t,e.dtab,256),e}function Cr(t){var e={max_sym:0},r=t.ReadByte();if(r!=5){console.error("Invalid FQZComp version number");return}var a=t.ReadByte(),n=a&ve?t.ReadByte():1,f=a.nparam>1?a.nparam-1:0,o=new Array(256);if(a&le)f=t.ReadByte(),X(t,o,256);else{for(var i=0;i<n;i++)o[i]=i;for(;i<256;i++)o[i]=n-1}e.do_rev=a&$r,e.stab=o,e.max_sel=f,e.params=new Array(e.nparam);for(var v=0;v<n;v++)e.params[v]=kr(t),e.max_sym<e.params[v].max_sym&&(e.max_sym=e.params[v].max_sym);return e}function Fr(t){var e={};e.qual=new Array(1<<16);for(var r=0;r<1<<16;r++)e.qual[r]=new W(t.max_sym+1);e.len=new Array(4);for(var r=0;r<4;r++)e.len[r]=new W(256);return e.rev=new W(2),e.dup=new W(2),t.max_sel>0&&(e.sel=new W(t.max_sel+1)),e}function Or(t,e,r,a,n,f){r.max_sel>0?n.s=a.sel.ModelDecode(t,e):n.s=0,n.x=r.stab[n.s];var o=r.params[n.x];if(o.fixed_len>=0){var i=a.len[0].ModelDecode(t,e);i|=a.len[1].ModelDecode(t,e)<<8,i|=a.len[2].ModelDecode(t,e)<<16,i|=a.len[3].ModelDecode(t,e)<<24,o.fixed_len>0&&(o.fixed_len=-i)}else i=-o.fixed_len;n.len=i,r.do_rev&&(f[n.rec]=a.rev.ModelDecode(t,e)),n.is_dup=0,o.pflags&ue&&a.dup.ModelDecode(t,e)&&(n.is_dup=1),n.p=i,n.delta=0,n.qctx=0,n.prevq=0,n.rec++}function Gr(t,e){var r=t.ReadUint7(),a=Cr(t);if(!!a){var n=a.params,f=new Array(e.length),o=Fr(a),i=new ze(t);i.RangeStartDecode(t);for(var v=new u.Buffer.allocUnsafe(r),h={qctx:0,prevq:0,delta:0,p:0,s:0,x:0,len:0,is_dup:0,rec:0},l=0;l<r;){if(h.p==0){if(Or(t,i,a,o,h,f),h.is_dup>0&&o.dup.ModelDecode(t,i)){for(var s=0;s<len;s++)v[l+s]=v[l+s-h.len];l+=h.len,h.p=0;continue}e.push(h.len);var n=a.params[h.x],d=n.context}var c=o.qual[d].ModelDecode(t,i);v[l++]=n.qmap[c],d=Ir(n,h,c)}return a.do_rev&&Pr(v,r,f,e),v}}function Pr(t,e,r,a){for(var n=0,f=0;f<e;){if(r[n])for(var o=0,i=a[n]-1;o<i;){var v=t[f+o];t[f+o]=t[f+i],t[f+i]=v,o++,i--}f+=a[n++]}}function zr(t,e){var r=new Pe(t);return Gr(r,e)}function Kr(t,e,r,a){for(var n=r[0],f=0;f<r.length&&r[f]==n;f++);for(var o=f==r.length?1:0,i=0,v=0,f=0;f<256;f++)a[0][f]=0;for(var h=0,l=0,f=0;f<t.length;f++)l==0&&(l=e[h<e.length-1?h++:h]),a[0][t[f]]++,l--;for(var f=0;f<256;f++)!a[0][f]||(v<f&&(v=f),i++);var s=5,d=0;return i<=16&&(d=1,i<=2?s=1:i<=4?s=2:i<=8?s=3:s=4),[{qbits:8+(s>4),qshift:s,qloc:7,pbits:7,pshift:e[0]>128?1:0,ploc:0,dbits:s>4?0:1,dshift:3,dloc:15,sbits:0,sloc:15,do_stab:0,context:0<<15,max_sym:v,nsym:i,do_qmap:d,do_dedup:0,fixed_len:e.length==1?1:0,do_sel:0,do_rev:0,do_pos:1,do_delta:s<=4?1:0,do_qtab:0,qbits:8+(s>4)-(o==0),sbits:1,sloc:15-(s<=4),do_stab:1,do_sel:1}]}function K(t,e,r){for(var a=0,n=0,f=new Array(r*2),o=0;a<r;){for(var i=a;a<r&&e[a]==n;)a++;var v=a-i;do{var h=Math.min(255,v);f[o++]=h,v-=h}while(h==255);n++}var l=-1,s=new Array(r*2),d=0;for(a=0;a<o;){var c=f[a++];if(s[d++]=c,c==l){for(var i=a;a<o&&f[a]==l&&a-i<255;)a++;s[d++]=a-i}else l=c}t.WriteData(s,d)}function Hr(t,e,r,a,n,f,o){for(var i=[0,1,1,1,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],v=0;v<e.length;v++)o[v]=v;for(;v<256;v++)o[v]=e.length-1;t.WriteByte(5);var h=(e.length>1?ve:0)|(e[0].do_stab?le:0);if(t.WriteByte(h),h&ve&&t.WriteByte(e.length),h&le){var l=1<<e[0].sbits;l>0&&l--,t.WriteByte(l),K(t,o,256)}for(var s=0;s<e.length;s++){if(t.WriteUint16(e[s].context),t.WriteByte((e[s].do_qtab?ie:0)|(e[s].do_delta?oe:0)|(e[s].do_pos?fe:0)|(e[s].do_qmap?ne:0)|(e[s].do_sel?He:0)|(e[s].fixed_len?Ke:0)|(e[s].do_dedup?ue:0)),e[s].do_qmap?t.WriteByte(e[s].nsym):t.WriteByte(e[s].max_sym),t.WriteByte(e[s].qbits<<4|e[s].qshift),t.WriteByte(e[s].qloc<<4|e[s].sloc),t.WriteByte(e[s].ploc<<4|e[s].dloc),e[s].do_qmap){e[s].max_sym=e[s].nsym;for(var d=0,v=0;v<256;v++)r[s][v]&&(t.WriteByte(v),r[s][v]=d++);for(;d<e[s].nsym;d++)t.WriteByte(0)}else for(var v=0;v<256;v++)r[s][v]=v;if(e[s].qbits>0){for(var v=0;v<256;v++)a[s][v]=v;e[s].do_qtab&&K(t,a[s],256)}if(e[s].pbits>0){for(var v=0;v<1024;v++)n[s][v]=Math.min((1<<e[s].pbits)-1,v>>e[s].pshift);K(t,n[s],1024)}if(e[s].dbits>0){for(var v=0;v<256;v++)i[v]>(1<<e[s].dbits)-1&&(i[v]=(1<<e[s].dbits)-1);for(var v=0;v<256;v++)f[s][v]=i[Math.min(i.length-1,v>>e[s].dshift)];K(t,f[s],256)}}return t}function Zr(t,e,r,a,n,f,o,i,v,h){var l=1<<n[0].sbits;l>0&&l--;for(var s=e.length,d=0,R=0;R<n.length;R++)d<n[R].max_sym&&(d=n[R].max_sym);for(var c=new Array(1<<16),B=0;B<1<<16;B++)c[B]=new W(d+1);for(var y=new Array(4),B=0;B<4;B++)y[B]=new W(256);new W(2),new W(2);for(var g=new W(l+1),w=new ze(e),R=0,B=0,we=0;B<s;){if(R==0){var V=a[we];n[0].sbits>0&&g.ModelEncode(t,w,V);var _=h[V],m=r[Math.min(r.length-1,we++)];n[_].fixed_len?n[_].fixed_len>0&&(y[0].ModelEncode(t,w,m&255),y[1].ModelEncode(t,w,m>>8&255),y[2].ModelEncode(t,w,m>>16&255),y[3].ModelEncode(t,w,m>>24&255),n[_].fixed_len=-1):(y[0].ModelEncode(t,w,m&255),y[1].ModelEncode(t,w,m>>8&255),y[2].ModelEncode(t,w,m>>16&255),y[3].ModelEncode(t,w,m>>24&255)),n[_].do_dedup&&Je.exit(1),R=m;var ge=0,p=n[_].context,T=0,Re=0}var Te=e[B++],O=f[_][Te];c[p].ModelEncode(t,w,O),T=(T<<n[_].qshift)+o[_][O],p=n[_].context,p+=(T&(1<<n[_].qbits)-1)<<n[_].qloc,n[_].pbits>0&&(p+=i[_][Math.min(R,1023)]<<n[_].ploc),n[_].dbits>0&&(p+=v[_][Math.min(ge,255)]<<n[_].dloc,ge+=Re!=O?1:0,Re=O),n[_].do_sel&&(p+=V<<n[_].sloc),p=p&65535,R--}return w.RangeFinishEncode(t),t.buf.slice(0,t.pos)}function Xr(t,e,r){for(var a=new Array(2),n=new Array(2),f=new Array(2),o=new Array(2),i=new Array(256),v=0;v<2;v++)a[v]=new Array(256),n[v]=new Array(256),f[v]=new Array(1024),o[v]=new Array(256);var l=new Pe("",0,t.length*1.1+100);l.WriteUint7(t.length);var h=Kr(t,e,r,a),l=Hr(l,h,a,n,f,o,i);return Zr(l,t,e,r,h,a,n,f,o,i)}var Vr={decode:zr,encode:Xr};const U=F,Ze=Ce,Tr=Ge;var Xe=new Tr;const D=0,L=1,$=2,q=3,Ve=4,x=5,he=6,E=7,I=8,k=9,ye=10,C=12;function Yr(t,e,r,a){for(var n=-1,f=new Array(256);!t.EOF();){var o=t.ReadByte(),i=o&128,v=o&64,h=o&63;if(i&&(n++,f[n]=new Array(13)),h!=D&&i){var l=new Array(a-1).fill(ye);f[n][D]=new U(u.Buffer.from([h].concat(l)))}if(v){var s=t.ReadByte(),d=t.ReadByte();f[n][h]=new U(f[s][d].buf)}else{var c=t.ReadUint7(),y=t.ReadData(c);r?f[n][h]=Xe.decode(y):f[n][h]=Ze.decode(y),f[n][h]=new U(f[n][h])}}return f}function me(t,e){for(var r=t+"";r.length<e;)r="0"+r;return r}function Jr(t,e,r,a){var n=t[0][D].ReadByte(),f=t[0][n].ReadUint32(),o=a-f;if(n==x)return e[a]=e[o],r[a]=r[o],e[a];var i=1;e[a]="",r[a]=new Array(256);do{switch(n=t[i][D].ReadByte(),n){case $:r[a][i]=t[i][$].ReadChar();break;case L:r[a][i]=t[i][L].ReadString();break;case E:r[a][i]=t[i][E].ReadUint32();break;case q:var v=t[i][q].ReadUint32(),h=t[i][Ve].ReadByte();r[a][i]=me(v,h);break;case I:r[a][i]=(r[o][i]>>0)+t[i][I].ReadByte();break;case k:var v=(r[o][i]>>0)+t[i][k].ReadByte(),h=r[o][i].length;r[a][i]=me(v,h);break;case ye:r[a][i]=r[o][i];break;default:r[a][i]="";break}e[a]+=r[a][i++]}while(n!=C);return e[a]}function Qr(a,e,r){var a=new U(a);a.ReadUint32();var n=a.ReadUint32(),f=a.ReadByte(),o=Yr(a,e,f,n),i=new Array(n),v=new Array(n),h="";typeof r>"u"&&(r=`
`);for(var l=0;l<n;l++)h+=Jr(o,i,v,l)+r;return h}function Nr(t,e){var r=t.toString();r[r.length-1]==`
`&&(r=r.substring(0,r.length-1));var a=r.split(`
`),n=new U("",0,r.length*2+1e4);n.WriteUint32(r.length),n.WriteUint32(a.length),n.WriteByte(e);for(var f=new Array(a.length),o={},i=new Array(256).fill(0),v=0,h=0,l=0;l<a.length;l++){var[s,d]=aa(f,o,i,a[l],l);v<s&&(v=s),h<d&&(h=d)}for(var c=0;c<v;c++){for(var y=new Array(C+1),g=0;g<=C;g++)y[g]=new U("",0,a.length*h);jr(y,f,c,a),ea(y,c,e,n)}return n.buf.slice(0,n.pos)}function jr(t,e,r,a,n,f){for(var o=0;o<a.length;o++)if(!(r>0&&e[o][0].type==x)&&!!e[o][r])switch(t[D].WriteByte(e[o][r].type),e[o][r].type){case he:t[he].WriteUint32(e[o][r].val);break;case x:t[x].WriteUint32(e[o][r].val);break;case L:t[L].WriteString(e[o][r].val);break;case $:t[$].WriteChar(e[o][r].val);break;case E:t[E].WriteUint32(e[o][r].val);break;case q:t[q].WriteUint32(e[o][r].val),t[Ve].WriteByte(e[o][r].val.length);break;case I:t[e[o][r].type].WriteByte(e[o][r].val);break;case k:t[e[o][r].type].WriteByte(e[o][r].val);break}}function ea(t,e,r,a){for(var n=0;n<=C;n++)if(!(t[n].pos<=0)){a.WriteByte(n+(n==0?128:0)),t[n]=t[n].buf.slice(0,t[n].pos);var f=ra(t[n],r);a.WriteUint7(f.length),a.WriteData(f,f.length)}}function ra(t,e){var r=1073741824,a,n=[0,1,64,65,128,129,193+8];for(var f in n){var o=n[f];if(!(o&1&&t.length<100)&&!(o&8&&t.length%4!=0)){try{var i=e?Xe.encode(t,o):Ze.encode(t,o)}catch{var i=0}i&&r>i.length&&(r=i.length,a=i)}}return a}function aa(t,e,r,a,n){var f=0,o=n-1;t[n]=new Array(256),e[a]?t[n][0]={type:x,val:n-e[a]}:t[n][0]={type:he,val:n==0?0:1},e[a]=n;for(var i=a.match(/([a-zA-Z0-9]{1,9})|([^a-zA-Z0-9]+)/g),v=0;v<i.length;v++){var h=v+1,l=L,s=i[v];if(i[v].match(/^0+[0-9]*$/g)?l=q:i[v].match(/^[0-9]+$/g)?l=E:i[v].length==1&&(l=$),o>=0&&t[o][h]){if(t[o][h].str==i[v])l=ye,s="";else if(t[o][h].type==E||t[o][h].type==I){var d=s-t[o][h].str;r[h]++,d>=0&&d<256&&r[h]>n/2&&(l=I,s=d)}else if((t[o][h].type==q||t[o][h].type==k)&&t[o][h].str.length==s.length){var d=s-t[o][h].str;r[h]++,d>=0&&d<256&&r[h]>n/2&&(l=k,s=d)}}t[n][h]={str:i[v],val:s,type:l},f<t[n][h].val.length+3&&(f=t[n][h].val.length+3)}return t[n][++h]={type:C},[h+1,f]}var ta={encode:Nr,decode:Qr},na=hr,fa=Ce,oa=Ge,ia=Vr,va=ta;function la(t,e){na.decode(t).copy(e,0,0)}function ha(t,e){fa.decode(t).copy(e,0,0)}function sa(t,e){oa.decode(t).copy(e,0,0)}function da(t,e){var r=new Array;ia.decode(t,r).copy(e,0,0)}function ca(t,e){var r=va.decode(t,0,"\0");u.Buffer.from(r,"binary").copy(e,0,0)}var ua={r4x8_uncompress:la,r4x16_uncompress:ha,arith_uncompress:sa,fqzcomp_uncompress:da,tok3_uncompress:ca};const Ba=ua;export{Ba as h};
