var v={};Object.defineProperty(v,"__esModule",{value:!0});function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function j(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},p(e)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},d(e,t)}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function F(e){var t=C();return function(){var r=p(e),o;if(t){var i=p(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return k(this,o)}}function N(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=p(e),e!==null););return e}function h(){return typeof Reflect<"u"&&Reflect.get?h=Reflect.get.bind():h=function(t,n,r){var o=N(t,n);if(!!o){var i=Object.getOwnPropertyDescriptor(o,n);return i.get?i.get.call(arguments.length<3?t:r):i.value}},h.apply(this,arguments)}var E=function(){function e(){O(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return _(e,[{key:"addEventListener",value:function(n,r,o){n in this.listeners||(this.listeners[n]=[]),this.listeners[n].push({callback:r,options:o})}},{key:"removeEventListener",value:function(n,r){if(n in this.listeners){for(var o=this.listeners[n],i=0,s=o.length;i<s;i++)if(o[i].callback===r){o.splice(i,1);return}}}},{key:"dispatchEvent",value:function(n){if(n.type in this.listeners){for(var r=this.listeners[n.type],o=r.slice(),i=0,s=o.length;i<s;i++){var f=o[i];try{f.callback.call(this,n)}catch(l){Promise.resolve().then(function(){throw l})}f.options&&f.options.once&&this.removeEventListener(n.type,f.callback)}return!n.defaultPrevented}}}]),e}(),g=function(e){j(n,e);var t=F(n);function n(){var r;return O(this,n),r=t.call(this),r.listeners||E.call(y(r)),Object.defineProperty(y(r),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(y(r),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(y(r),"reason",{value:void 0,writable:!0,configurable:!0}),r}return _(n,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(o){o.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,o)),h(p(n.prototype),"dispatchEvent",this).call(this,o)}}]),n}(E),w=function(){function e(){O(this,e),Object.defineProperty(this,"signal",{value:new g,writable:!0,configurable:!0})}return _(e,[{key:"abort",value:function(n){var r;try{r=new Event("abort")}catch{typeof document<"u"?document.createEvent?(r=document.createEvent("Event"),r.initEvent("abort",!1,!1)):(r=document.createEventObject(),r.type="abort"):r={type:"abort",bubbles:!1,cancelable:!1}}var o=n;if(o===void 0)if(typeof document>"u")o=new Error("This operation was aborted"),o.name="AbortError";else try{o=new DOMException("signal is aborted without reason")}catch{o=new Error("This operation was aborted"),o.name="AbortError"}this.signal.reason=o,this.signal.dispatchEvent(r)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();typeof Symbol<"u"&&Symbol.toStringTag&&(w.prototype[Symbol.toStringTag]="AbortController",g.prototype[Symbol.toStringTag]="AbortSignal");function q(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):typeof e.Request=="function"&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}function I(e){typeof e=="function"&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,o=r===void 0?n.Request:r,i=t.AbortController,s=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,f=s===void 0?!1:s;if(!q({fetch:n,Request:o,AbortController:i,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:f}))return{fetch:n,Request:l};var l=o;(l&&!l.prototype.hasOwnProperty("signal")||f)&&(l=function(b,a){var c;a&&a.signal&&(c=a.signal,delete a.signal);var u=new o(b,a);return c&&Object.defineProperty(u,"signal",{writable:!1,enumerable:!1,configurable:!0,value:c}),u},l.prototype=o.prototype);var R=n,P=function(b,a){var c=l&&l.prototype.isPrototypeOf(b)?b.signal:a?a.signal:void 0;if(c){var u;try{u=new DOMException("Aborted","AbortError")}catch{u=new Error("Aborted"),u.name="AbortError"}if(c.aborted)return Promise.reject(u);var m=new Promise(function(S,T){c.addEventListener("abort",function(){return T(u)},{once:!0})});return a&&a.signal&&delete a.signal,Promise.race([m,R(b,a)])}return R(b,a)};return{fetch:P,Request:l}}var B=v.AbortController=w,x=v.AbortSignal=g;v.abortableFetch=I;export{B as A,x as a,v as c};
